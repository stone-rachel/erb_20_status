<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ERB RUNNERS Â· Team Board</title>

    <!-- âœ… SUIT(ì •ì‚¬ê°/ê°ì§„ ëŠë‚Œ) + Pretendard + Poppins -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/static/woff2/SUIT.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #f6f7f9;
        --card: #ffffff;
        --text: #101828;
        --sub: #667085;
        --muted: #98a2b3;
        --line: rgba(16, 24, 40, 0.08);

        --shadow: 0 10px 30px rgba(16, 24, 40, 0.08);
        --shadow2: 0 6px 18px rgba(16, 24, 40, 0.06);

        /* top3 */
        --gold: #f6c343;
        --silver: #cfd6e6;
        --bronze: #c97b4a;
        --grayBadge: #94a3b8;

        --blue: #3182f6;
        --blue2: #1d4ed8;

        --radius: 22px;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        /* âœ… ì „ì²´ì ìœ¼ë¡œ ë‘”íƒí•¨ ì¤„ì´ê¸°: ê¸°ë³¸ì„ SUITë¡œ (ê°ì§„/ì •ì‚¬ê°), ë‘ê»ì§€ ì•Šê²Œ */
        font-family:
          SUIT,
          Pretendard,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          "Apple SD Gothic Neo",
          "Noto Sans KR",
          "Malgun Gothic",
          sans-serif;
        background: var(--bg);
        color: var(--text);
        overflow-x: hidden;
      }

      /* ===== Running track background ===== */
      .bgTrack {
        position: fixed;
        inset: -140px -180px auto auto;
        width: 760px;
        height: 760px;
        opacity: 0.1;
        pointer-events: none;
        z-index: 0;
      }
      .bgTrack2 {
        position: fixed;
        inset: auto auto -220px -220px;
        width: 860px;
        height: 860px;
        opacity: 0.08;
        pointer-events: none;
        z-index: 0;
        transform: rotate(12deg);
      }

      .wrap {
        max-width: 780px;
        margin: 0 auto;
        padding: 18px 14px 32px;
        position: relative;
        z-index: 1;
      }

      header {
        padding: 10px 2px 14px;
      }

      /* âœ… ìƒë‹¨ ì „ì²´ ì¢Œì¸¡ ì •ë ¬ */
      header,
      .hero,
      .heroTop,
      .progWrap,
      .progTop,
      .dataInfo {
        text-align: left;
      }
      .heroTop {
        justify-content: flex-start;
      }
      .controls {
        margin-left: auto;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 0;
        margin-bottom: 12px;
      }
      .logo {
        width: 38px;
        height: 38px;
        border-radius: 14px;
        background: linear-gradient(135deg, #3182f6, #a78bfa);
        box-shadow: 0 10px 18px rgba(16, 24, 40, 0.14);
        flex: 0 0 auto;
      }
      .brandText {
        min-width: 0;
      }
      .brandTitle {
        font-weight: 800; /* âœ… 1000 â†’ 800 */
        letter-spacing: -0.1px;
        font-size: 14px;
        line-height: 1.15;
      }
      .brandSub {
        display: block;
        margin-top: 2px;
        font-size: 12px;
        color: var(--sub);
        line-height: 1.15;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 460px;
      }

      .hero {
        padding: 16px 18px 16px;
        border-radius: var(--radius);
        background: #fff;
        border: 1px solid var(--line);
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
      }
      .hero::before {
        content: "";
        position: absolute;
        inset: -120px -220px auto auto;
        width: 520px;
        height: 520px;
        background:
          radial-gradient(
            circle at 30% 30%,
            rgba(49, 130, 246, 0.18),
            transparent 55%
          ),
          radial-gradient(
            circle at 70% 60%,
            rgba(167, 139, 250, 0.14),
            transparent 55%
          );
        pointer-events: none;
      }

      .heroTop {
        display: flex;
        align-items: flex-start;
        gap: 14px;
        flex-wrap: wrap;
        position: relative;
        z-index: 1;
      }

      h1 {
        margin: 0;
        font-size: 36px;
        line-height: 1.06;
        letter-spacing: -0.8px;
        font-weight: 900; /* âœ… 1000 â†’ 900 */
      }
      .subtitle {
        margin-top: 6px;
        font-size: 13px;
        color: var(--sub);
        line-height: 1.3;
        font-weight: 600; /* âœ… ì¡°ê¸ˆ ë” ì •ëˆ */
      }
      .smallLine {
        margin-top: 6px;
        font-size: 12px;
        color: var(--muted);
        line-height: 1.35;
        font-weight: 600;
      }

      /* ===== Program progress runner bar ===== */
      .progWrap {
        margin-bottom: 12px;
        position: relative;
        z-index: 1;
      }
      .progTop {
        display: flex;
        align-items: baseline;
        justify-content: space-between;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 6px;
      }
      .progTitle {
        font-size: 12px;
        font-weight: 800;
        color: var(--sub);
        letter-spacing: -0.1px;
      } /* âœ… 1000 â†’ 800 */
      .progPct {
        font-family: SUIT, "Poppins", system-ui, sans-serif;
        font-size: 12px;
        font-weight: 700;
        color: var(--muted);
      }

      .progTrackWrap {
        position: relative;
        padding-top: 22px;
      }
      .progTrack {
        position: relative;
        height: 12px;
        border-radius: 999px;
        background: rgba(16, 24, 40, 0.06);
        border: 1px solid rgba(16, 24, 40, 0.06);
        overflow: hidden;
      }
      .progFill {
        position: absolute;
        inset: 0 auto 0 0;
        width: 0%;
        border-radius: 999px;
        background: linear-gradient(
          90deg,
          rgba(246, 195, 67, 1),
          rgba(255, 79, 216, 1),
          rgba(59, 130, 246, 1)
        );
      }
      .runner {
        position: absolute;
        top: 0;
        left: 0px;
        transform: translateX(-50%);
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(16, 24, 40, 0.1);
        box-shadow: 0 10px 18px rgba(16, 24, 40, 0.1);
        backdrop-filter: blur(8px);
        white-space: nowrap;
        user-select: none;
        z-index: 2;
      }
      .runnerIcon {
        font-size: 14px;
        line-height: 1;
      }
      .runnerText {
        font-family: SUIT, "Poppins", system-ui, sans-serif;
        font-size: 12px;
        font-weight: 700;
        color: var(--text);
        letter-spacing: -0.1px;
      }
      .progMeta {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 6px;
        color: var(--muted);
        font-size: 11px;
        font-family: SUIT, "Poppins", system-ui, sans-serif;
        font-weight: 600;
      }

      /* ===== Data reflected bar under Week ===== */
      .dataInfo {
        margin-top: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }
      .dataInfoText {
        font-size: 12px;
        color: var(--sub);
        font-weight: 700;
        letter-spacing: -0.1px;
      } /* âœ… 800 â†’ 700 */
      .dataBar {
        width: 220px;
        height: 8px;
        border-radius: 999px;
        background: rgba(16, 24, 40, 0.06);
        overflow: hidden;
        border: 1px solid rgba(16, 24, 40, 0.06);
      }
      .dataBarFill {
        height: 100%;
        width: 0%;
        border-radius: 999px;
        background: linear-gradient(
          90deg,
          rgba(246, 195, 67, 1),
          rgba(255, 79, 216, 1),
          rgba(59, 130, 246, 1)
        );
      }

      /* ===== Controls ===== */
      .controls {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      .pill {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        border-radius: 999px;
        background: #fff;
        border: 1px solid var(--line);
        box-shadow: var(--shadow2);
      }
      .pill span {
        color: var(--muted);
        font-size: 12px;
        font-weight: 800;
        letter-spacing: 0.02em;
      } /* âœ… 900 â†’ 800 */
      input[type="text"] {
        border: none;
        outline: none;
        background: transparent;
        color: var(--text);
        width: 210px;
        font-size: 14px;
        font-weight: 700; /* âœ… 800 â†’ 700 */
        font-family: SUIT, Pretendard, system-ui, sans-serif;
      }
      input[type="text"]::placeholder {
        color: #c0c7d2;
        font-weight: 600;
      }

      .btn {
        border: none;
        cursor: pointer;
        padding: 10px 12px;
        border-radius: 999px;
        background: rgba(49, 130, 246, 0.1);
        border: 1px solid rgba(49, 130, 246, 0.18);
        color: var(--blue2);
        font-weight: 800; /* âœ… 1000 â†’ 800 */
        font-family: SUIT, Pretendard, system-ui, sans-serif;
        box-shadow: var(--shadow2);
      }
      .btn:hover {
        background: rgba(49, 130, 246, 0.14);
      }

      main {
        margin-top: 14px;
      }
      .sheet {
        background: transparent;
        padding: 0;
      }

      /* ===== Row Card ===== */
      .row {
        position: relative;
        background: var(--card);
        border-radius: 28px;
        border: 1px solid var(--line);
        box-shadow: var(--shadow2);
        padding: 18px 18px 26px;
        margin: 18px 0;

        display: grid;
        grid-template-columns: 1fr auto;
        gap: 16px;

        overflow: visible;
      }

      .row.top1::before,
      .row.top2::before,
      .row.top3::before {
        content: "";
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        height: 7px;
        border-radius: 28px 28px 0 0;
      }
      .row.top1::before {
        background: linear-gradient(
          90deg,
          rgba(246, 195, 67, 0.95),
          rgba(246, 195, 67, 0.1)
        );
      }
      .row.top2::before {
        background: linear-gradient(
          90deg,
          rgba(207, 214, 230, 0.95),
          rgba(207, 214, 230, 0.12)
        );
      }
      .row.top3::before {
        background: linear-gradient(
          90deg,
          rgba(201, 123, 74, 0.95),
          rgba(201, 123, 74, 0.1)
        );
      }

      .leftBlock {
        display: flex;
        gap: 14px;
        align-items: flex-start;
        min-width: 0;
      }

      .teamBlock {
        flex: 1;
        min-width: 0;
      }
      .team,
      .members {
        width: 100%;
        text-align: left;
        max-width: none;
      }

      /* =========================================================
       âœ… Medal: ë‹¤ì´ì•„ ë¬¸ì–‘ ì œê±° + ì°¸ê³  ì´ë¯¸ì§€ì²˜ëŸ¼ "ëŒ€ê°ì„  ë¼ì¸" ê´‘íƒ
       ========================================================= */

      .rankBadge {
        --ribA: #b6c2d6;
        --ribB: #8fa0bf;

        position: relative;
        width: 62px;
        height: 62px;
        flex: 0 0 auto;
        border-radius: 18px;
        isolation: isolate;
        display: grid;
        place-items: center;

        box-shadow:
          0 14px 22px rgba(2, 6, 23, 0.18),
          0 6px 10px rgba(2, 6, 23, 0.1);
      }
      .rankBadge.top3d {
        box-shadow:
          0 18px 28px rgba(2, 6, 23, 0.22),
          0 8px 14px rgba(2, 6, 23, 0.12);
      }

      .rankBadge::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 18px;
        transform: translateY(6px);
        z-index: -1;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.18),
          rgba(0, 0, 0, 0.35)
        );
        filter: saturate(1.05);
      }

      /* ribbon legs */
      .rankBadge::before {
        content: "";
        position: absolute;
        left: 50%;
        bottom: -18px;
        width: 40px;
        height: 28px;
        transform: translateX(-50%);
        z-index: -2;

        background:
          linear-gradient(
            180deg,
            rgba(255, 255, 255, 0.18),
            rgba(0, 0, 0, 0.14)
          ),
          linear-gradient(180deg, var(--ribA), var(--ribB)) left/16px 100%
            no-repeat,
          linear-gradient(180deg, var(--ribA), var(--ribB)) right/16px 100%
            no-repeat;

        filter: drop-shadow(0 10px 14px rgba(2, 6, 23, 0.18));
        border-radius: 0 0 12px 12px;
        opacity: 0.98;
      }

      .rankBadge .badgeFace {
        position: absolute;
        inset: 0;
        border-radius: 18px;
        overflow: hidden;
        display: grid;
        place-items: center;
      }

      /* âœ… Embossed rim + diagonal sheen lines */
      .rankBadge .badgeFace::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 18px;
        pointer-events: none;

        /* 1) ì…ì²´ í…Œë‘ë¦¬ */
        box-shadow:
          inset 0 0 0 4px rgba(255, 255, 255, 0.72),
          inset 0 0 0 7px rgba(255, 255, 255, 0.18),
          inset 0 -14px 18px rgba(2, 6, 23, 0.1),
          inset 0 10px 16px rgba(255, 255, 255, 0.18);

        /* 2) ì°¸ê³  ì´ë¯¸ì§€ ëŠë‚Œ: ëŒ€ê°ì„  ê´‘íƒ ë¼ì¸ (ë‹¤ì´ì•„/ì¹© ì œê±°) */
        background:
        /* êµµì€ ëŒ€ê°ì„  í•˜ì´ë¼ì´íŠ¸ */
          linear-gradient(
            135deg,
            rgba(255, 255, 255, 0.55) 0%,
            rgba(255, 255, 255, 0.2) 18%,
            rgba(255, 255, 255, 0) 42%,
            rgba(255, 255, 255, 0.16) 62%,
            rgba(255, 255, 255, 0) 82%
          ),
          /* ê°€ëŠ” ëŒ€ê°ì„  ë¼ì¸ 2~3ê°œ */
          repeating-linear-gradient(
              135deg,
              rgba(255, 255, 255, 0.18) 0px,
              rgba(255, 255, 255, 0.18) 2px,
              rgba(255, 255, 255, 0) 14px,
              rgba(255, 255, 255, 0) 22px
            );

        opacity: 0.95;
        mix-blend-mode: screen;
      }

      /* âœ… ê¸°ì¡´ 'ë‹¤ì´ì•„ëª¬ë“œ/ì¹©' ê´‘íƒ ì œê±° */
      .rankBadge .badgeFace::after {
        content: none;
      }

      .rankBadge .badgeFace span {
        position: relative;
        z-index: 2;
        font-family:
          SUIT, "Poppins", system-ui, sans-serif; /* âœ… ìˆ«ìë„ ê°ì§„ ëŠë‚Œ */
        font-weight: 900;
        font-size: 26px;
        line-height: 1;
        letter-spacing: -0.02em;
        color: rgba(255, 255, 255, 0.96);
        text-shadow:
          0 2px 0 rgba(0, 0, 0, 0.18),
          0 10px 18px rgba(0, 0, 0, 0.18);
        transform: translateY(-1px);
      }

      /* ribbon color overlays per rank */
      .rankBadge.gold {
        --ribA: #ff4fd8;
        --ribB: #ff73e3;
      }
      .rankBadge.silver {
        --ribA: #2f7bff;
        --ribB: #56a0ff;
      }
      .rankBadge.bronze {
        --ribA: #ffb000;
        --ribB: #ff6a2a;
      }
      .rankBadge.gray {
        --ribA: #93a4c3;
        --ribB: #6f83a6;
      }

      /* badge face color themes */
      .rankBadge.gold .badgeFace {
        background: linear-gradient(
          135deg,
          #ffcc33 0%,
          #ffb000 35%,
          #ffea7a 100%
        );
      }
      .rankBadge.gold::after {
        background: linear-gradient(180deg, #e39a00, #c97f00);
      }

      .rankBadge.silver .badgeFace {
        background: linear-gradient(
          135deg,
          #c9d4e6 0%,
          #95a6c6 45%,
          #e8eef9 100%
        );
      }
      .rankBadge.silver::after {
        background: linear-gradient(180deg, #7b8cab, #64748b);
      }

      .rankBadge.bronze .badgeFace {
        background: linear-gradient(
          135deg,
          #d98a4f 0%,
          #b8612f 45%,
          #f2c19b 100%
        );
      }
      .rankBadge.bronze::after {
        background: linear-gradient(180deg, #8b4a23, #6b3416);
      }

      .rankBadge.gray .badgeFace {
        background: linear-gradient(
          135deg,
          #a7b3c7 0%,
          #7f8ea7 45%,
          #d7deea 100%
        );
      }
      .rankBadge.gray::after {
        background: linear-gradient(180deg, #667085, #475467);
      }
      .rankBadge.gray .badgeFace span {
        color: rgba(255, 255, 255, 0.92);
      }

      /* =========================================================
       âœ… Typography (ë‘”íƒí•¨ ê°œì„ )
       3) ì¡° ì´ë¦„: ìê°„ ì‚´ì§ ë„“íˆê³ , êµµê¸° ì¤„ì´ê¸°
       ========================================================= */
      .team {
        font-weight: 800; /* âœ… 1000 â†’ 800 */
        font-size: 22px;
        letter-spacing: 0.02em; /* âœ… ì‚´ì§ ë„“í˜ */
        line-height: 1.12;
        color: var(--text);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
      }
      .members {
        margin-top: 10px;
        color: var(--sub);
        font-size: 14px;
        line-height: 1.45;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        letter-spacing: -0.05px; /* âœ… ë„ˆë¬´ íƒ€ì´íŠ¸í•œ ëŠë‚Œ ì™„í™” */
        font-weight: 600;
      }

      /* Right score block */
      .right {
        text-align: right;
        min-width: 170px;
        font-variant-numeric: tabular-nums;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        justify-content: flex-start;
        gap: 10px;
        padding-top: 2px;
      }
      .meta {
        display: flex;
        flex-direction: column;
        gap: 6px;
        align-items: flex-end;
      }
      .labels {
        font-family: SUIT, "Poppins", system-ui, sans-serif; /* âœ… ê°ì§„ ëŠë‚Œ */
        color: var(--muted);
        font-size: 12px;
        letter-spacing: 0.16em;
        user-select: none;
        font-weight: 700; /* âœ… 700 ìœ ì§€(ë„ˆë¬´ ì–‡ìœ¼ë©´ íë¦¼) */
      }
      .numbersLine {
        font-family: SUIT, "Poppins", system-ui, sans-serif; /* âœ… ê°ì§„ ëŠë‚Œ */
        color: var(--sub);
        font-size: 13px;
        user-select: none;
        font-weight: 600;
        letter-spacing: 0;
        font-variant-numeric: tabular-nums;
        -webkit-font-smoothing: antialiased;
      }

      /* 1) íŒ€ë³„ ì´ì ìˆ˜: ì¡°ê¸ˆ ë” ì–‡ê²Œ */
      .total {
        font-family:
          SUIT, "Poppins", system-ui, sans-serif; /* âœ… 2) ì •ì‚¬ê° ëŠë‚Œ */
        font-size: 44px;
        font-weight: 700; /* âœ… 800 â†’ 700 (ì¡°ê¸ˆë§Œ ë” ì–‡ê²Œ) */
        line-height: 1;
        color: #111827;
        letter-spacing: -0.4px; /* âœ… -0.6 â†’ -0.4 (ê°ì§„ í°íŠ¸ì— ìì—°ìŠ¤ëŸ½ê²Œ) */
        text-rendering: geometricPrecision;
        -webkit-font-smoothing: antialiased;
        margin-top: 2px;
      }
      .total.rank1 {
        color: var(--gold);
      }
      .total.rank2 {
        color: #9aa6bf;
      }
      .total.rank3 {
        color: var(--bronze);
      }

      /* Perfect sticker */
      .perfectSticker {
        position: absolute;
        top: -16px;
        right: 18px;
        z-index: 5;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 8px 14px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.96);
        border: 1px solid rgba(16, 24, 40, 0.12);
        box-shadow: 0 14px 22px rgba(16, 24, 40, 0.14);
        backdrop-filter: blur(10px);
        font-family: SUIT, "Poppins", Pretendard, system-ui, sans-serif;
        font-weight: 800;
        font-size: 14px;
        background-image: linear-gradient(
          90deg,
          rgba(246, 195, 67, 1) 0%,
          rgba(255, 79, 216, 1) 45%,
          rgba(59, 130, 246, 1) 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      /* progress */
      .progressTrack {
        position: absolute;
        left: 18px;
        right: 18px;
        bottom: 12px;
        height: 7px;
        border-radius: 999px;
        background: rgba(16, 24, 40, 0.06);
        overflow: hidden;
      }
      .progressFill {
        height: 100%;
        width: 0%;
        background: linear-gradient(
          90deg,
          rgba(49, 130, 246, 1),
          rgba(29, 78, 216, 1)
        );
        border-radius: 999px;
      }

      .hint {
        color: var(--sub);
        font-size: 12px;
        margin: 10px 4px 0;
        line-height: 1.45;
        font-weight: 600;
      }

      details {
        margin-top: 14px;
        border-radius: var(--radius);
        background: #fff;
        border: 1px solid var(--line);
        padding: 12px 14px;
        color: var(--text);
        box-shadow: var(--shadow2);
      }
      summary {
        cursor: pointer;
        font-weight: 800;
        color: var(--text);
      } /* âœ… 1000 â†’ 800 */
      textarea {
        width: 100%;
        min-height: 120px;
        resize: vertical;
        margin-top: 10px;
        border-radius: 16px;
        border: 1px solid var(--line);
        background: #fbfcfe;
        color: var(--text);
        padding: 12px;
        outline: none;
        font-family:
          ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 12px;
      }
      .rowSmall {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-top: 10px;
        flex-wrap: wrap;
      }

      /* âœ… ëª¨ë°”ì¼: í…ìŠ¤íŠ¸ ì•ˆ ì˜ë¦¬ê²Œ + ì ìˆ˜ ì˜ì—­ ì•„ë˜ë¡œ */
      @media (max-width: 520px) {
        input[type="text"] {
          width: 160px;
        }
        h1 {
          font-size: 32px;
        }

        .row {
          grid-template-columns: 1fr;
          gap: 10px;
          padding: 16px 16px 22px;
        }

        .team {
          font-size: 18px;
          white-space: normal;
          overflow: hidden;
          text-overflow: clip;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          letter-spacing: 0.02em;
        }
        .members {
          font-size: 13px;
          white-space: normal;
          overflow: hidden;
          text-overflow: clip;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
        }

        .right {
          width: 100%;
          min-width: 0;
          flex-direction: row;
          justify-content: space-between;
          align-items: flex-end;
          text-align: left;
          padding-top: 0;
          margin-top: 2px;
        }
        .meta {
          align-items: flex-start;
        }
        .labels {
          font-size: 11px;
        }
        .numbersLine {
          font-size: 12px;
        }
        .total {
          font-size: 36px;
          letter-spacing: -0.3px;
          font-weight: 700;
        }

        .perfectSticker {
          right: 14px;
          top: -14px;
        }
        .dataBar {
          width: 180px;
        }
        .progMeta {
          font-size: 10px;
        }
        .progPct {
          font-size: 11px;
        }
      }
    </style>
  </head>

  <body>
    <!-- Track backgrounds -->
    <svg
      class="bgTrack"
      viewBox="0 0 600 600"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M80 310C140 180 260 120 370 120C520 120 560 230 560 300C560 410 470 490 350 490C220 490 150 420 150 340C150 270 200 240 250 240"
        stroke="rgba(49,130,246,1)"
        stroke-width="18"
        stroke-linecap="round"
      />
      <path
        d="M110 330C170 210 285 160 380 160C490 160 520 250 520 300C520 390 450 450 350 450C250 450 200 400 200 340C200 290 240 270 280 270"
        stroke="rgba(167,139,250,1)"
        stroke-width="10"
        stroke-linecap="round"
      />
      <path
        d="M145 350C205 245 315 205 395 205C470 205 490 265 490 300C490 365 435 410 350 410C275 410 240 375 240 340C240 310 265 300 300 300"
        stroke="rgba(246,195,67,1)"
        stroke-width="6"
        stroke-linecap="round"
      />
    </svg>

    <svg
      class="bgTrack2"
      viewBox="0 0 600 600"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M70 320C150 170 290 110 405 120C535 133 575 250 560 325C540 430 445 505 320 500C210 495 140 420 150 345C160 275 230 240 275 240"
        stroke="rgba(16,24,40,1)"
        stroke-width="16"
        stroke-linecap="round"
        opacity=".55"
      />
      <path
        d="M120 350C190 230 310 175 405 185C495 195 520 265 505 320C485 400 420 445 330 445C250 445 205 405 210 350C215 310 250 290 290 290"
        stroke="rgba(49,130,246,1)"
        stroke-width="8"
        stroke-linecap="round"
        opacity=".35"
      />
    </svg>

    <div class="wrap">
      <header>
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div class="brandText">
            <div class="brandTitle">ERB RUNNERS</div>
            <small class="brandSub">íŒ€ í˜„í™© Â· ìë™ ìˆœìœ„ Â· Perfect í‘œì‹œ</small>
          </div>
        </div>

        <div class="hero">
          <!-- overall program progress -->
          <div class="progWrap">
            <div class="progTop">
              <div class="progTitle">ì „ì²´ ê¸°ê°„ ì§„í–‰ë„</div>
              <div class="progPct" id="progPct">0%</div>
            </div>

            <div
              class="progTrackWrap"
              id="progTrackWrap"
              aria-label="ì „ì²´ ê¸°ê°„ ì§„í–‰ ë°”"
            >
              <div class="progTrack" id="progTrack">
                <div class="progFill" id="progFill"></div>
              </div>

              <div class="runner" id="runner" aria-hidden="true">
                <span class="runnerIcon">ğŸƒâ€â™‚ï¸</span>
                <span class="runnerText" id="runnerText">ì˜¤ëŠ˜</span>
              </div>
            </div>

            <div class="progMeta">
              <span id="progStart">2025.12.14</span>
              <span id="progEnd">2026.05.02</span>
            </div>
          </div>

          <div class="heroTop">
            <div>
              <h1 id="weekTitle">Week 1</h1>
              <div class="subtitle" id="subtitle"></div>

              <div class="dataInfo">
                <div class="dataInfoText" id="dataRefText">
                  ë°ì´í„° ë°˜ì˜: ì´ 20ì£¼ ì¤‘ Week 5ê¹Œì§€
                </div>
                <div class="dataBar" aria-hidden="true">
                  <div class="dataBarFill" id="dataRefBar"></div>
                </div>
              </div>

              <div class="smallLine" id="rangeLine"></div>
            </div>

            <div class="controls">
              <div class="pill">
                <span>ê²€ìƒ‰</span>
                <input id="q" type="text" placeholder="íŒ€ëª…/íŒ€ì› ê²€ìƒ‰" />
              </div>
              <button class="btn" id="copyLink">í˜„ì¬ ìƒíƒœ ë§í¬ ë³µì‚¬</button>
            </div>
          </div>
        </div>
      </header>

      <main>
        <div class="sheet">
          <div id="board"></div>
        </div>

        <div class="hint">
          * ì ìˆ˜ëŠ” R(ì½ê¸°) / Z(ì¤Œë¯¸íŒ…) / E(ì´ë²¤íŠ¸) í•©ê³„ë¡œ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.
          ë§Œì (=Rmax+Zmax+Emax)ì¼ ê²½ìš° Perfectê°€ í‘œì‹œë©ë‹ˆë‹¤.
        </div>

        <details>
          <summary>CSVë¡œ ë°ì´í„° ë¶™ì—¬ë„£ê¸°</summary>
          <div class="hint" style="margin-top: 8px">
            í—¤ë” í¬í•¨ CSV ì˜ˆì‹œ: team,members,R,Z,E (membersëŠ” | ë¡œ êµ¬ë¶„)
          </div>
          <textarea
            id="csv"
            placeholder="team,members,R,Z,E
ì¡°ì´ë¦„,íŒ€ì›1|íŒ€ì›2|íŒ€ì›3|íŒ€ì›4|íŒ€ì›5,196,10,0
ì¡°ì´ë¦„,íŒ€ì›1|íŒ€ì›2|íŒ€ì›3|íŒ€ì›4|íŒ€ì›5,178,10,0"
          ></textarea>
          <div class="rowSmall">
            <button class="btn" id="loadCsv">CSV ì ìš©</button>
            <button class="btn" id="resetData">ê¸°ë³¸ ë°ì´í„°ë¡œ ë˜ëŒë¦¬ê¸°</button>
          </div>
        </details>
      </main>
    </div>

    <script>
      /** =========================
       *  â˜… Google Sheets ì—°ë™ ì„¤ì •
       *  ========================= */
      // TODO: ì—¬ê¸°ì— Google Sheets IDë¥¼ ì…ë ¥í•˜ì„¸ìš”
      // ì‹œíŠ¸ URLì´ https://docs.google.com/spreadsheets/d/XXXXX/edit ë¼ë©´
      // XXXXX ë¶€ë¶„ì´ SHEET_IDì…ë‹ˆë‹¤
      const SHEET_ID = "11GMO9pGnq-mGonfBOjhzbi1FttAAC86OIgbsgUqlKoc";

      // ì‹œíŠ¸ ì´ë¦„ (íƒ­ ì´ë¦„, ê¸°ë³¸ê°’ì€ ì²« ë²ˆì§¸ ì‹œíŠ¸)
      const SHEET_NAME = "ì§‘ê³„"; // ë¹„ì›Œë‘ë©´ ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©

      /** =========================
       *  0) ë°ì´í„° ë°˜ì˜(ì´ 20ì£¼ ì¤‘ 4ì£¼ ë°˜ì˜)
       *  ========================= */
      const TOTAL_WEEKS = 20;
      const DATA_UP_TO_WEEK = 5;

      /** =========================
       *  1) ì ìˆ˜ ë§Œì  ê¸°ì¤€(í•„ìš” ì‹œ ìˆ˜ì •)
       *  ========================= */
      const SCORE_MAX = { R: 245, Z: 10, E: 0 };
      const TOTAL_MAX = SCORE_MAX.R + SCORE_MAX.Z + SCORE_MAX.E;

      /** =========================
       *  2) ì „ì²´ ì„±ê²½ì½ê¸° ê¸°ê°„(ê³ ì •)
       *  ========================= */
      const PROGRAM_START = "2025-12-14"; // ì¼ìš”ì¼
      const PROGRAM_END = "2026-05-02"; // í† ìš”ì¼

      function toKSTDateOnly(yyyy_mm_dd) {
        const [y, m, d] = yyyy_mm_dd.split("-").map(Number);
        return new Date(y, m - 1, d);
      }
      function fmtKR(d) {
        const y = d.getFullYear();
        const m = String(d.getMonth() + 1).padStart(2, "0");
        const day = String(d.getDate()).padStart(2, "0");
        return `${y}.${m}.${day}`;
      }
      function clamp(n, min, max) {
        return Math.max(min, Math.min(max, n));
      }

      function getProgramWeekInfo(today = new Date()) {
        const start = toKSTDateOnly(PROGRAM_START);
        const end = toKSTDateOnly(PROGRAM_END);
        const t = new Date(
          today.getFullYear(),
          today.getMonth(),
          today.getDate()
        );

        if (t < start)
          return { status: "before", week: 0, weekStart: null, weekEnd: null };
        if (t > end)
          return { status: "after", week: 0, weekStart: null, weekEnd: null };

        const diffDays = Math.floor((t - start) / (1000 * 60 * 60 * 24));
        const week = Math.floor(diffDays / 7) + 1;

        const weekStart = new Date(start);
        weekStart.setDate(start.getDate() + (week - 1) * 7);

        const weekEnd = new Date(weekStart);
        weekEnd.setDate(weekStart.getDate() + 6);

        return { status: "in", week, weekStart, weekEnd };
      }

      function updateProgramProgress(today = new Date()) {
        const start = toKSTDateOnly(PROGRAM_START);
        const end = toKSTDateOnly(PROGRAM_END);
        const t = new Date(
          today.getFullYear(),
          today.getMonth(),
          today.getDate()
        );

        const total = end - start;
        const done = t - start;

        let pct = 0;
        if (total > 0) pct = (done / total) * 100;
        pct = clamp(pct, 0, 100);

        const progFill = document.getElementById("progFill");
        const runner = document.getElementById("runner");
        const progPct = document.getElementById("progPct");
        const runnerText = document.getElementById("runnerText");
        const progStart = document.getElementById("progStart");
        const progEnd = document.getElementById("progEnd");
        const track = document.getElementById("progTrack");

        progStart.textContent = fmtKR(start);
        progEnd.textContent = fmtKR(end);

        progFill.style.width = `${pct.toFixed(1)}%`;

        const w = track.getBoundingClientRect().width;
        const x = (pct / 100) * w;
        const pad = 22;
        const clampedX = Math.max(pad, Math.min(w - pad, x));
        runner.style.left = `${clampedX}px`;

        const label = t < start ? "ì‹œì‘ ì „" : t > end ? "ì™„ë£Œ!" : "ì˜¤ëŠ˜";
        runnerText.textContent = label;

        progPct.textContent = `${pct.toFixed(1)}%`;
      }

      /** =========================
       *  3) ë°ì´í„°
       *  ========================= */
      const DEFAULT_DATA = [
        {
          team: "ê¾¸ì¤€íˆë§¤ì¼ì½(1)ì¡°",
          members: ["êµ¬ì¬ì—°", "ì–‘ì†¡ë¹ˆ", "ì‹ ì€ì„­", "ê¹€ìì—°", "ì‹ ì°¬í¬"],
          R: 196,
          Z: 10,
          E: 0,
        },
        {
          team: "JOY",
          members: ["ì†¡ì†”ë‚´", "ê¹€ì´ˆì›", "ì†¡ë¯¸ì†Œ", "ê¹€ì˜ˆì§€", "ì´ì§€ì›"],
          R: 178,
          Z: 10,
          E: 0,
        },
        {
          team: "ì™„ë…í•˜ì¡°",
          members: ["ì„ë‹¤í¬", "í™©ì€ì •", "ì—„ì£¼ìš©", "ì´ìˆ˜í˜„", "ë¥˜ì—°ìš°"],
          R: 196,
          Z: 10,
          E: 0,
        },
        {
          team: "ì˜¤ëŠ˜ë„ì½ì¡°",
          members: ["ìµœí¬ì„ ", "ê¹€ì§€ë¯¼", "ê¹€ìœ ë¦¬", "ë°•ë‹¤ì˜", "ì´ì˜ˆì°¬"],
          R: 147,
          Z: 10,
          E: 0,
        },
        {
          team: "5ëŠ˜ë„ì™„ë…",
          members: ["ìœ¤í˜„ì„", "Regan", "ì±„í¬ë€", "ì±„ì§€í˜œ", "ì¡°ì€ì„œ"],
          R: 181,
          Z: 0,
          E: 0,
        },
        {
          team: "í‚´ìŠ¤ì•¤í™©",
          members: ["ê¹€ìˆœí™”", "Ji-Ho Kim", "í™©ë³´ë¼", "ê¹€ì§€ë¯¼", "ê¹€ë‚˜ê²½"],
          R: 193,
          Z: 10,
          E: 0,
        },
        {
          team: "7ì¡°",
          members: ["ìµœì§€ì€", "í™©í˜„ì£¼", "í™©ì§„ê²½", "ìœ ì •", "ì „í•˜ìš´"],
          R: 186,
          Z: 0,
          E: 0,
        },
        {
          team: "íŒ”ì•„í”„ë‹ˆê¹Œí•„ì‚¬í•˜ì§€ë§ê³ ê¼¬ë°•ê¼¬ë°•ì½ì¡°",
          members: ["ì´ë„ì—°", "ë°•ë„í˜„", "ì¥ìœ¤ìˆ˜", "ê¹€í™˜ê·¼", "ì„±ëª…ê·œ"],
          R: 154,
          Z: 10,
          E: 0,
        },
        {
          team: "ì˜ì½9ì‹¶ì¡°",
          members: ["ì¡°ê²½ìœ¤", "ë¥˜ë¹„ì·¨", "ê¹€ì˜ˆì€", "ê¹€ì§€ìœ¤", "ê¹€ìœ¤í™”"],
          R: 190,
          Z: 10,
          E: 0,
        },
        {
          team: "TT(Team Ten)",
          members: ["ë°•ì£¼í˜„", "ì„œìˆ˜ì—°", "ìµœë¯¼ìˆ˜", "ì´ì¬ì§„", "ìµœê°•"],
          R: 171,
          Z: 0,
          E: 0,
        },
        {
          team: "KTVM",
          members: ["Liliana", "Yami", "ì–‘ì‹œì€", "ê¹€í¬ì •"],
          R: 138,
          Z: 10,
          E: 0,
        },
        {
          team: "ì—´ì‹­ì´ì¡°",
          members: ["ê¹€ìš©ë¹ˆ", "ê³ ì±„ì€", "ì´í˜œì§„", "ì†¡ì¤€ë¯¸", "ì •ìˆ˜ì—°"],
          R: 196,
          Z: 10,
          E: 0,
        },
        {
          team: "K5",
          members: ["ê¹€í•˜ì€", "ê¹€ì§€ë‹´", "ì´ê²½ì€", "ê³ ì€ë¹ˆ", "ê¹€ì€ì„œ"],
          R: 196,
          Z: 10,
          E: 0,
        },
      ];

      let state = structuredClone(DEFAULT_DATA);

      function normalize(s) {
        return (s ?? "").toString().trim().toLowerCase();
      }
      function calcTotal(t) {
        return (Number(t.R) || 0) + (Number(t.Z) || 0) + (Number(t.E) || 0);
      }
      function isPerfect(t) {
        return calcTotal(t) === TOTAL_MAX;
      }

      function applyRanking(sorted) {
        let rank = 0;
        let prevScore = null;
        return sorted.map((t) => {
          const score = calcTotal(t);
          if (prevScore === null || score !== prevScore) rank += 1;
          prevScore = score;
          return { ...t, rank, total: score };
        });
      }

      function medalClass(rank) {
        if (rank === 1) return "gold";
        if (rank === 2) return "silver";
        if (rank === 3) return "bronze";
        return "gray";
      }
      function totalRankClass(rank) {
        if (rank === 1) return "rank1";
        if (rank === 2) return "rank2";
        if (rank === 3) return "rank3";
        return "";
      }

      function escapeHtml(str) {
        return (str ?? "")
          .toString()
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function updateHeaderWeek() {
        const info = getProgramWeekInfo(new Date());
        const titleEl = document.getElementById("weekTitle");
        const subEl = document.getElementById("subtitle");
        const rangeEl = document.getElementById("rangeLine");
        const dataText = document.getElementById("dataRefText");
        const dataBar = document.getElementById("dataRefBar");

        updateProgramProgress(new Date());

        rangeEl.textContent = `ê¸°ê°„: ${PROGRAM_START.replaceAll("-", ".")} ~ ${PROGRAM_END.replaceAll("-", ".")} Â· ë§Œì  ${TOTAL_MAX}ì  (R ${SCORE_MAX.R} / Z ${SCORE_MAX.Z} / E ${SCORE_MAX.E})`;

        dataText.textContent = `ë°ì´í„° ë°˜ì˜: ì´ ${TOTAL_WEEKS}ì£¼ ì¤‘ Week ${DATA_UP_TO_WEEK}ê¹Œì§€`;
        const pct = clamp((DATA_UP_TO_WEEK / TOTAL_WEEKS) * 100, 0, 100);
        dataBar.style.width = `${pct.toFixed(0)}%`;

        if (info.status === "before") {
          titleEl.textContent = "Week 0";
          subEl.textContent = `ì „ì²´ ì„±ê²½ì½ê¸° Â· ì‹œì‘ ì „`;
          return;
        }
        if (info.status === "after") {
          titleEl.textContent = "Completed";
          subEl.textContent = `ì „ì²´ ì„±ê²½ì½ê¸° Â· ì¢…ë£Œ`;
          return;
        }
        titleEl.textContent = `Week ${info.week}`;
        subEl.textContent = `ì „ì²´ ì„±ê²½ì½ê¸° Â· ${info.week}ì£¼ì°¨ (${fmtKR(info.weekStart)} ~ ${fmtKR(info.weekEnd)})`;
      }

      function render() {
        updateHeaderWeek();

        const q = normalize(document.getElementById("q").value);
        const filtered = state.filter((t) => {
          if (!q) return true;
          const hay = normalize(t.team) + " " + normalize(t.members.join(" "));
          return hay.includes(q);
        });

        const sorted = [...filtered].sort((a, b) => {
          const ta = calcTotal(a),
            tb = calcTotal(b);
          if (tb !== ta) return tb - ta;
          return a.team.localeCompare(b.team, "ko");
        });

        const ranked = applyRanking(sorted);

        const board = document.getElementById("board");
        board.innerHTML =
          ranked
            .map((t) => {
              const perfect = isPerfect(t);
              const pct = TOTAL_MAX
                ? clamp((t.total / TOTAL_MAX) * 100, 0, 100)
                : 0;
              const topClass =
                t.rank === 1
                  ? "top1"
                  : t.rank === 2
                    ? "top2"
                    : t.rank === 3
                      ? "top3"
                      : "";
              const isTop3 = t.rank <= 3;

              return `
      <div class="row ${topClass}">
        ${perfect ? `<div class="perfectSticker">Perfect</div>` : ``}

        <div class="leftBlock">
          <div class="rankBadge ${medalClass(t.rank)} ${isTop3 ? "top3d" : ""}">
            <div class="badgeFace"><span>${t.rank}</span></div>
          </div>

          <div class="teamBlock">
            <div class="team">${escapeHtml(t.team)}</div>
            <div class="members">${escapeHtml(t.members.join(", "))}</div>
          </div>
        </div>

        <div class="right">
          <div class="meta">
            <div class="labels">R&nbsp;&nbsp;Z&nbsp;&nbsp;E</div>
            <div class="numbersLine">${Number(t.R) || 0}&nbsp;&nbsp;${Number(t.Z) || 0}&nbsp;&nbsp;${Number(t.E) || 0}</div>
          </div>
          <div class="total ${totalRankClass(t.rank)}">${t.total}</div>
        </div>

        <div class="progressTrack">
          <div class="progressFill" style="width:${pct.toFixed(1)}%"></div>
        </div>
      </div>
    `;
            })
            .join("") ||
          `<div style="padding:14px; color:#667085; font-family:SUIT, Pretendard, system-ui, sans-serif;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
      }

      function encodeStateToUrl() {
        const payload = state.map((t) => ({
          team: t.team,
          members: t.members,
          R: Number(t.R) || 0,
          Z: Number(t.Z) || 0,
          E: Number(t.E) || 0,
        }));
        const json = JSON.stringify(payload);
        const b64 = btoa(unescape(encodeURIComponent(json)));
        const url = new URL(location.href);
        url.searchParams.set("data", b64);
        return url.toString();
      }

      function decodeStateFromUrl() {
        const url = new URL(location.href);
        const b64 = url.searchParams.get("data");
        if (!b64) return false;
        try {
          const json = decodeURIComponent(escape(atob(b64)));
          const arr = JSON.parse(json);
          if (!Array.isArray(arr)) return false;
          state = arr.map((x) => ({
            team: x.team ?? "",
            members: Array.isArray(x.members) ? x.members : [],
            R: Number(x.R) || 0,
            Z: Number(x.Z) || 0,
            E: Number(x.E) || 0,
          }));
          return true;
        } catch (e) {
          console.warn("Failed to load data from URL:", e);
          return false;
        }
      }

      function parseCsv(text) {
        const lines = text
          .split(/\r?\n/)
          .map((l) => l.trim())
          .filter(Boolean);
        if (lines.length < 2) return null;

        const header = lines[0].split(",").map((h) => h.trim());
        const idx = {
          team: header.findIndex((h) => normalize(h) === "team"),
          members: header.findIndex((h) => normalize(h) === "members"),
          R: header.findIndex((h) => normalize(h) === "r"),
          Z: header.findIndex((h) => normalize(h) === "z"),
          E: header.findIndex((h) => normalize(h) === "e"),
        };
        if (idx.team < 0) return null;

        const out = [];
        for (let i = 1; i < lines.length; i++) {
          const cols = lines[i].split(",");
          const team = (cols[idx.team] ?? "").trim();
          if (!team) continue;

          const membersRaw = (
            idx.members >= 0 ? (cols[idx.members] ?? "") : ""
          ).trim();
          const members = membersRaw
            ? membersRaw
                .split("|")
                .map((s) => s.trim())
                .filter(Boolean)
            : [];

          out.push({
            team,
            members,
            R: Number(cols[idx.R] ?? 0) || 0,
            Z: Number(cols[idx.Z] ?? 0) || 0,
            E: Number(cols[idx.E] ?? 0) || 0,
          });
        }
        return out;
      }

      document.getElementById("q").addEventListener("input", render);

      document
        .getElementById("copyLink")
        .addEventListener("click", async () => {
          try {
            const link = encodeStateToUrl();
            await navigator.clipboard.writeText(link);
            alert("í˜„ì¬ ë°ì´í„°ê°€ í¬í•¨ëœ ë§í¬ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.");
          } catch (e) {
            alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”)");
          }
        });

      document.getElementById("loadCsv").addEventListener("click", () => {
        const text = document.getElementById("csv").value;
        const parsed = parseCsv(text);
        if (!parsed) {
          alert(
            "CSV í˜•ì‹ì„ í™•ì¸í•´ ì£¼ì„¸ìš”. (í—¤ë” í¬í•¨: team,members,R,Z,E / membersëŠ” | ë¡œ êµ¬ë¶„)"
          );
          return;
        }
        state = parsed;
        render();
      });

      document.getElementById("resetData").addEventListener("click", () => {
        state = structuredClone(DEFAULT_DATA);
        const url = new URL(location.href);
        url.searchParams.delete("data");
        history.replaceState({}, "", url.toString());
        render();
      });

      window.addEventListener("resize", () => updateHeaderWeek());

      /** =========================
       *  Google Sheets ë°ì´í„° ë¡œë“œ
       *  ========================= */
      async function loadFromGoogleSheets() {
        if (!SHEET_ID || SHEET_ID === "YOUR_SHEET_ID_HERE") {
          console.log("Google Sheets IDê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ. ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©.");
          return false;
        }

        try {
          // ë¡œë”© ìƒíƒœ í‘œì‹œ
          const board = document.getElementById("board");
          board.innerHTML = `<div style="padding:24px; color:#667085; font-family:SUIT, Pretendard, system-ui, sans-serif; text-align:center;">
            <div style="font-size:24px; margin-bottom:8px;">â³</div>
            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
          </div>`;

          const sheetParam = SHEET_NAME
            ? `&sheet=${encodeURIComponent(SHEET_NAME)}`
            : "";
          const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json${sheetParam}`;

          const response = await fetch(url);
          const text = await response.text();

          // Googleì˜ ì‘ë‹µì€ "google.visualization.Query.setResponse({...})" í˜•íƒœ
          // JSON ë¶€ë¶„ë§Œ ì¶”ì¶œ
          const jsonMatch = text.match(
            /google\.visualization\.Query\.setResponse\(([\s\S]+)\);?$/
          );
          if (!jsonMatch) {
            throw new Error("Google Sheets ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨");
          }

          const data = JSON.parse(jsonMatch[1]);
          const rows = data.table.rows;
          const cols = data.table.cols;

          // í—¤ë” ì¸ë±ìŠ¤ ì°¾ê¸° (í•œê¸€ ì»¬ëŸ¼ëª… ì§€ì›)
          const headerMap = {};
          const findHeader = (label) => {
            const l = label.toLowerCase().trim();
            if (l === "íŒ€ëª…" || l === "team") return "team";
            if (l === "íŒ€ì›ëª…" || l === "members") return "members";
            if (l.includes("ì½ê¸°") || l === "r") return "R";
            if (l.includes("ì¤Œ") || l === "z") return "Z";
            if (l.includes("ì´ë²¤íŠ¸") || l === "e") return "E";
            return null;
          };

          cols.forEach((col, idx) => {
            const key = findHeader(col.label || "");
            // ë¨¼ì € ë§¤ì¹­ëœ ì»¬ëŸ¼ ìš°ì„  (ì¤‘ë³µ ë°©ì§€: "ì¤Œ" vs "1ì°¨ ì¤Œë¯¸íŒ…")
            if (key && headerMap[key] === undefined) headerMap[key] = idx;
          });

          // ì²« ë²ˆì§¸ í–‰ì´ ìƒìœ„ í—¤ë”ì¸ ê²½ìš° ìŠ¤í‚µ (ì˜ˆ: "3ì£¼ì°¨ ì§‘ê³„" ë“±)
          // ì‹¤ì œ í—¤ë”ë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ìŠ¤í‚µ
          while (headerMap.team === undefined && rows.length > 0) {
            const currentRow = rows[0].c;
            const tempMap = {};

            currentRow.forEach((cell, idx) => {
              const val = (cell?.v || "").toString();
              const key = findHeader(val);
              if (key) tempMap[key] = idx;
            });

            // "íŒ€ëª…" ì»¬ëŸ¼ì„ ì°¾ì•˜ìœ¼ë©´ ì´ í–‰ì´ í—¤ë”
            if (tempMap.team !== undefined) {
              Object.assign(headerMap, tempMap);
              rows.shift(); // í—¤ë” í–‰ ì œê±°
              break;
            }

            // ì•„ë‹ˆë©´ ìƒìœ„ í—¤ë”ë¡œ ê°„ì£¼í•˜ê³  ìŠ¤í‚µ
            rows.shift();
          }

          if (headerMap.team === undefined) {
            throw new Error("'íŒ€ëª…' ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
          }

          // ë°ì´í„° íŒŒì‹±
          const parsed = [];
          for (const row of rows) {
            const cells = row.c;
            const team = (cells[headerMap.team]?.v || "").toString().trim();
            if (!team) continue;

            const membersRaw =
              headerMap.members !== undefined
                ? (cells[headerMap.members]?.v || "").toString().trim()
                : "";
            const members = membersRaw
              ? membersRaw
                  .split(",")
                  .map((s) => s.trim())
                  .filter(Boolean)
              : [];

            parsed.push({
              team,
              members,
              R: Number(cells[headerMap.R]?.v) || 0,
              Z: Number(cells[headerMap.Z]?.v) || 0,
              E: Number(cells[headerMap.E]?.v) || 0,
            });
          }

          if (parsed.length === 0) {
            throw new Error("ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤");
          }

          state = parsed;
          console.log(
            `Google Sheetsì—ì„œ ${parsed.length}ê°œ íŒ€ ë°ì´í„° ë¡œë“œ ì™„ë£Œ`
          );
          return true;
        } catch (error) {
          console.error("Google Sheets ë¡œë“œ ì‹¤íŒ¨:", error);
          alert(
            `Google Sheets ë¡œë“œ ì‹¤íŒ¨: ${error.message}\nê¸°ë³¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.`
          );
          return false;
        }
      }

      // ì´ˆê¸°í™”
      async function init() {
        // URL íŒŒë¼ë¯¸í„°ì— ë°ì´í„°ê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš©
        const hasUrlData = decodeStateFromUrl();

        // URL ë°ì´í„°ê°€ ì—†ìœ¼ë©´ Google Sheetsì—ì„œ ë¡œë“œ
        if (!hasUrlData) {
          await loadFromGoogleSheets();
        }

        render();
      }

      init();
    </script>
  </body>
</html>



